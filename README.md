This code may be slow if you enter a long password.